<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="../Style/style.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;400&display=swap" rel="stylesheet">


    <link rel="apple-touch-icon" sizes="180x180" href="../../IMG/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../IMG/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../IMG/favicon_io/favicon-16x16.png">
    <script src="../../../mvc/mascarasInputs.js"></script>

    <title>Cadastro de Empresa</title>
    <script src="../verificarLogin.js"></script>
    <script src="../mascaras.js"></script>

    <script>
        async function handleCadastroEmpresa(event) {
            /*alert("Função handleLogin chamada"); // Para testar*/

            event.preventDefault(); // Impede o envio do formulário padrão

            const nm_empresa = document.getElementById('nm_empresa').value;
            const cnpj_empresa = document.getElementById('cnpj_empresa').value;
            const email_empresa = document.getElementById('email_empresa').value;
            const segmento_empresa = document.getElementById('segmento_empresa').value;
            const senha_empresa = document.getElementById('senha_empresa').value;
            const confSenhaEmpresa = document.getElementById('confSenhaEmpresa').value;

            // Verifica se as senhas coincidem
            if (senha_empresa !== confSenhaEmpresa) {
                alert("As senhas não coincidem. Tente novamente.");
                return;
            }

            // Faz a requisição para o back-end
            const response = await fetch('/empresa', {

                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    nm_empresa,
                    cnpj_empresa,
                    email_empresa,
                    segmento_empresa,
                    senha_empresa
                })
            });

            // Processa a resposta
            const data = await response.json();

            if (response.ok) {
                alert("Empresa cadastrada com sucesso!");
                window.location.href = "../LoginEmpresa/loginEmpresa.html";
            } else {
                // Exibe o erro retornado pelo back-end
                alert("Erro: " + data.message);  // Mensagem de erro (ex: "Usuário já cadastrado.")
            }
        }
    </script>

</head>

<body id="bodymod">

    <!--Começo Header-->
    <header id="header1">

        <div id="container1">

            <div class="row" id="rowheader">

                <div class="col-2">

                    <a href="../Index/index.html">
                        <img src="../../IMG/Logo.jpeg" alt="IMG Logo" id="logo1">
                    </a>



                </div>

                <div class="col-10">

                    <nav id="navapc">
                        <ul id="navlista">
                            <li id="navlistaLI"><a href="../Produtos/produtos.html" id="links">Produtos</a></li>
                            <li id="navlistaLI"><a href="../Suporte/suporte.html" id="links">Suporte</a></li>
                            <li id="navlistaLI"><a href="../Planos/planos.html" id="links">Planos</a></li>
                            <li id="navlistaLI"><a href="../Duvidas/duvidas.html" id="links">Duvidas</a></li>

                            <button onclick="verificarLogin()" style="border: none; background-color: white;"><img
                                    id="logoicone" src="../../IMG/5907.jpg" alt=""></button>
                            <button onclick="verificarLogin2()" style="border: none; background-color: white;"><img
                                    id="logoicone" src="../../IMG/carrinho.jpg" alt=""></button>

                        </ul>
                    </nav>



                </div>


            </div>

        </div>

    </header>
    <!--Fim Header-->



    <!--Começo Cadastro da Empresa-->
    <section class="arealogin">
        <div class="log2">
            <div>
                <h1 id="nomeLogo">SOLARISPOWER</h1>

            </div>

            <form method="post" onsubmit="handleCadastroEmpresa(event)">
                <input type="text" name="nm_empresa" id="nm_empresa" placeholder="Nome da Empresa" maxlength="30"
                    autofocus>
                <input type="text" name="cnpj_empresa" id="cnpj_empresa" placeholder="CNPJ" oninput="mascaraCNPJ(this)" maxlength="18">
                <input type="text" name="email_empresa" id="email_empresa" placeholder="Email da Empresa"
                    maxlength="50">
                <input type="text" name="segmento_empresa" id="segmento_empresa" placeholder="Segmento da Empresa"
                    maxlength="30">
                <input type="password" name="senha_empresa" id="senha_empresa" placeholder="Sua senha" maxlength="20">
                <input type="password" name="confSenhaEmpresa" id="confSenhaEmpresa" placeholder="Confirmação"
                    maxlength="20">
                <input id="botao2" type="submit" value="Criar Conta!">
                <p id="pcad">
                    <a id="acad" href="../LoginEmpresa/loginEmpresa.html" align-text="center">Login Empresa</a> /
                    <a id="acad" href="../Cadastro/CadastroUsuario.html" align-text="center">Cadastrar Usuário</a>
                </p>
            </form>

        </div>


    </section>
    <!--Fim Cadastro da Empresa-->









    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>


</body>

</html>